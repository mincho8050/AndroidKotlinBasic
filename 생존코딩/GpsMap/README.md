# chapter10 GpsMap

난이도 : ★★☆

프로젝트명 : GpsMap

기능

- GPS로 현재 위치 정보를 얻어 지도에 표시한다.
- 주기적으로 현재 위치를 갱신하며 선을 그린다.

핵심 구성요소

- Google Maps Activity : 지도를 표시하는 기본 템플릿
- FusedLocationProviderClient : 현재 위치 정보를 얻는 클래스

라이브러리 설정

- Anko : 인텐트, 다이얼로그, 로그 등을 구현하는 데 도움이 되는 라이브러리
- play-services-maps : 구글 지도 라이브러리
- play-services-location : 위치 정보 라이브러리





## 0) 해법 요약

구글 지도에 나의 위치를 표시하고 이동 경로를 표시한다. 액티비티 하나로 구성되며

Google Maps Activity 템플릿을 활용한다. 지도를 활용해 현재 위치 정보를 사용하려면 권한 요청을 수행해야 한다. 주기적으로 현재 위치를 업데이트 받으려면 액티비티 생명주기에 따라 위치 업데이트 리스너를 등록 및 해제해야 한다.

구현 순서

1. 준비하기 : 프로젝트 생성 및 안드로이드 설정
2. 스텝 1 : 구글 지도 표시하기
3. 스텝 2 : 현재 위치 정보 얻기
4. 스텝 3 : 주기적으로 현재 위치 정보 업데이트 하기
5. 스텝 4 : 이동 자취를 선으로 그리기



## 1) 구글 지도 표시하기

기본 액티비티로 MapsActivity를 선택하는 것이 구글 지도를 사용하는 가장 쉬운 방법이다. 구글 지도를 사용하려면 API 키를 발급받아야 한다.

API키는 중요 열쇠이다. 분실 또는 다수에게 노출하지 말아야 한다. 보통 API 키마다 사용횟수 등의 제한이 있다. 지금까지는 모바일 기기에서 구글 지도 사용이 무제한 무료였지만 앞으로는 유료화 된다고 한다.

구현 순서

1. 구글 지도 API 키 발급받기
2. MapsActivity 기본 코드 분석





## 2) 주기적으로 현재 위치 정보 업데이트 하기

구현 순서

1. 매니페스트에 위치 권한 추가
2. onResume() 메서드에서 위치 정보 요청
3. 위치 정보 갱신 콜백 정의
4. onPause() 메서드에서 위치 정보 요청 중지







## 3) 이동 자취를 선으로 그리기

구글 지도는 이동 자취를 그리는 다양한 메서드를 제공

- addPolyLine() : 선의 집합으로 지도에 경로와 노선을 표시
- addCircle() : 원을 표시
- addPolygon() : 영역을 표시

이번 프로젝트에서는 addPolyLine() 메서드를 사용해서 이동 자취를 그린다

구현 순서

1. 이동 경로 그리기
2. 화면 유지하기
3. 에뮬레이터에서 테스트하기(실제 기계로 테스트 했기 때문에 이 과정은 하지 않았다.)







## 4) 마치며

이번 프로젝트에서는 구글 지도를 사용하여 이동 경로를 그리는 예제를 다뤄봤다.

- 액티비티 생성 시 Google Maps Activity를 선택하면 쉽게 구글 지도가 내장된 액티비티로 시작할 수 있다.
- 구글 지도는 API키를 발급받아 사용할 수 있다.
- 사용자의 위치 정보를 얻으려면 위치 권한이 필요하다. 위치 권한은 위험 권한이기 때문에 실행 중에 사용자에게 권한을 요청해야 한다.
- 구글 지도에는 선, 원, 폴리곤 등을 그리는 API가 준비되어 있다.
- 기기가 없어도 에뮬레이터에서 GPS를 테스트 할 수 있다.





















