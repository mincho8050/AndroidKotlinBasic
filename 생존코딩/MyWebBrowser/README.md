# chapter7 MyWebBrowser

난이도 : ★☆☆

프로젝트명 : MyWebBrowser

기능

- 웹 페이지를 탐색한다.
- 홈 메뉴를 클릭하여 첫 페이지로 온다.
- 메뉴에는 검색 사이트와 개발자 정보가 표시된다.
- 페이지를 문자나 메일로 공유할 수 있다.

핵심 구성요소

- WebView : 웹페이지를 표시하는 뷰
- 옵션 메뉴 : 상단 툴바에 표시하는 메뉴
- 컨텍스트 메뉴 : 뷰를 롱클릭하면 표시되는 메뉴
- 암시적 인텐트 : 문자 보내기, 이메일 보내기와 같이 미리 정의된 인텐트

라이브러리 설정

- Anko : 인텐트, 다이얼로그, 로그 등을 구현하는데 도움되는 라이브러리





## 0) 해법 요약

나만의 웹 브라우저는 웹을 표시하는 화면 하나와 여러 메뉴로 구성된다. 이 프로젝트에서는 웹 페이지를 표시하는 방법과 메뉴 사용법을 익힌다. 특히 옵션 메뉴와 컨텍스트 메뉴를 다루고 웹 페이지 주소를 공유하는 방법으로 암시적 인텐트를 다룬다.

구현순서

1. 준비하기 : 프로젝트 생성 및 안드로이드 설정
2. 스텝 1 : 테마 수정하기
3. 스텝 2 : 기본 웹 브라우저 기능 작성
4. 스텝 3 : 옵션 메뉴 사용하기
5. 스텝 4 :  컨텍스트 메뉴 사용하기
6. 스텝 5 : 암시적 인텐트





## 1) 준비하기

프로젝트를 생성하고 Anko라이브러리 설정하기.





## 2) 화면작성

테마를 변경하는 방법을 알아보고 화면을 작성한다. 

구현순서

1. 테마수정
2. 전체 동작 알아보기
3. 검색 창 EditText 배치
4. WebView 배치





## 3) 기본 웹 브라우저 기능 작성

레이아웃을 작성한 후 먼저 웹 브라우저의 기본 기능을 작성해야한다. 웹 페이지를 표시하려면 인터넷 권한이 필수이다. 권한을 설정하고 기본적인 웹 브라우저의 기능을 구현한다.

구현순서

1. 인터넷 권한 설정
2. 웹뷰에 웹 페이지 표시하기
3. 키보드의 검색 버튼 동작 정의하기
4. 뒤로가기 동작 재정의





## 4) 옵션 메뉴 사용하기

상단 툴바에 표시되는 메뉴를 옵션 메뉴라고 한다. 

옵선 메뉴를 사용하려면 다음 순서를 기억해야한다!

1. 메뉴 리소스를 준비한다.
2. onCreateOptionMenu() 메서드를 재정의하여 메뉴를 붙이고 true를 반환한다.
3. onOptionItemSelected() 메서드를 재정의하여 메뉴 아이템이 선택되었을 때의 처리를 분기한다.

옵션 메뉴를 작성하고 액티비티에 적용한다. 구현순서

1. 메뉴 리소스 파일 생성 및 벡터 이미지 준비
2. 메뉴 작성
3. 옵션 메뉴를 액티비티에 표시하기
4. 옵션 메뉴 클릭 이벤트 처리





## 5) 컨텍스트 메뉴 사용하기

특정 뷰를 길게 클릭하고 있으면 표시되는 메뉴가 있는데 이것을 컨텍스트 메뉴라고 한다.

컨텍스트 메뉴처럼 메뉴 리소스를 사용하며 액티비티에 작성하는 코드만 약간 다르다. 다음 순서를 기억하자.

1. 메뉴 리소스 작성
2. onCreateContextMenu() 메서드를 재정의하여 메뉴를 붙인다
3. onContextItemSelected() 메서드를 재정의하고 메뉴를 선택했을 때의 분기 처리
4. registerForContextMenu(View view) 메서드에 컨텍스트 메뉴가 표시되었으면 하는 뷰를 지정합니다.

컨텍스트 메뉴를 다음 순서로 작성한다.

1. 메뉴 리소스 파일 생성
2. 메뉴 작성
3. 컨텍스트 메뉴 등록하기
4. 컨텍스트 메뉴 클릭 이벤트 처리







## 6) 암시적 인텐트

안드로이드에는 미리 정의된 인텐트들이 있고 이걸 암시적 인텐트라고 한다. 암시적 인텐트에 대해 알아보고 메뉴와 연동하여 사용한다.

구현순서

1. 암시적 인텐트란.
2. 암시적 인텐트의 종류
3. Anko를 활용한 암시적 인텐트
4. 메뉴와 암시적 인텐트 연동



#### 6-1) 암시적 인텐트 종류

4) 옵션 메뉴 클릭 이벤트 처리에서 사용한 코드에는 전화 앱에 번호를 입력해주는 코드가 있다. 암시적 인텐트는 대부분 이러한 형태를 띄고 있다.



##### 전화걸기 암시적 인텐트

```kotlin
val intent = Intent(Intent.ACTION_DIAL)				//1
intent.data = Uri.parse("tel:031-123-4567")			//2
if(intent.resolveActivity(packageManager)!=null){	//3
    startActivity(intent)
}
```

1. 인텐트를 정의하며 Intent 클래스에 정의된 액션 중 하나를 지정한다. ACTION_DIAL액션은 전화 다이얼을 입력해주는 액션이다.
2. 인텐트에 데이터를 지정한다. 'tel:'로 시작하는 Uri는 전화번호를 나타내는 국제표준 방법이다. 이를 Uri.parse() 메서드로 감싼 Uri 객체를 데이터로 설정한다
3. intent.resolveActivity() 메서드는 이 인텐트를 수행하는 액티비티가 있는지를 검사하여 반환한다. null이 반환된다면 수행하는 액티비티가 없는 것이다. 전화 앱이 없는 태블릿 같은 경우에 해당한다.



이 외에도 암시적 인텐트 중에서 많이 사용되는 두 가지



##### 문자열 보내기

```kotlin
val intent = Intent(Intent.ACTION_SEND)
intent.apply {
    type="text/plain"
    putExtra(Intent.EXTRA_TEXT, "보낼 문자열")
    var chooser = Intent.createChooser(intent,null)
    if(intent.resolveActivity(packageManager)!=null){
        startActivity(chooser)
    }
}
```

##### 웹 브라우저 띄우기

```kotlin
val intent = Intent(Intent.ACTION_VIEW)
intent.data = Uri.parse("http://www.example.com")
if(intent.resolveActivity(packageManager)!=null){
    startActivity(intent)
}
```



#### 6-2) Anko를 활용한 암시적 인텐트

Anko 라이브러리를 사용하면 복잡한 암시적 인텐트 사용 코드를 획기적으로 줄일 수 있다. 한줄이면 된다. 

##### Anko에서 지원하는 암시적 인텐트.

> []는 옵션이다

| 종류                 | 코드                               |
| -------------------- | ---------------------------------- |
| 전화걸기             | makeCall(전화번호)                 |
| 문자보내기           | sendSms(전화번호,[문자열])         |
| 웹 브라우저에서 열기 | browse(url)                        |
| 문자열 공유          | share(문자열,[제목])               |
| 이메일 보내기        | email(받는 메일주소,[제목],[내용]) |



일반적으로 가장 자주 사용되는 암시적 인텐트이다. 단, 전화걸기는 Anko에서 지원하는 방법을 사용하지 않는다. 전화걸기는 별도의 권한을 추가해야 하고 사용자는 다이얼 입력까지만 제공해도 스스로 전화를 걸면 되기 때문이다. 책에서 전화걸기 암시적 인텐트는 특별한 경우가 아니면 사용하지 않는 것을 권한다.





## 7) 에뮬레이터 실행 화면



#### 7-1) 실행 화면

![01](https://user-images.githubusercontent.com/49340180/62207900-4b55e280-b3d0-11e9-9e69-a2ae3dc7ec15.PNG)

#### 7-2) 검색창 눌렀을 때의 모습

키보드창의 엔터키가 돋보기로 되어있음

![02](https://user-images.githubusercontent.com/49340180/62207950-76403680-b3d0-11e9-8540-9330fef78356.PNG)

#### 7-3) 옵션메뉴 눌렀을 때

![03](https://user-images.githubusercontent.com/49340180/62208014-9e2f9a00-b3d0-11e9-8288-faa110ae40cf.PNG)

##### 7-3-1) 옵션메뉴 > 검색 사이트 눌렀을 때

![04](https://user-images.githubusercontent.com/49340180/62208197-1ac27880-b3d1-11e9-8165-3ade6c8b7ed2.PNG)

클릭하면 각각의 사이트로 이동

##### 7-3-2) 옵션메뉴 > 개발자 정보 눌렀을 때

![05](https://user-images.githubusercontent.com/49340180/62208108-d6cf7380-b3d0-11e9-91ee-bb61aca73b33.PNG)

각각의 메뉴로 이동



#### 7-4) 컨텍스트 메뉴 

![06](https://user-images.githubusercontent.com/49340180/62208139-f23a7e80-b3d0-11e9-8e50-b30b809db7ac.PNG)







## 8) 마치며

이번 프로젝트에서는 리소스 중에서 테마와 메뉴를 주로 다뤘다. 앱의 외관이나 메뉴를 구성하는 일은 아주 중요해서 잘 숙지해야 한다. 마지막에 다뤘던 암시적 인텐트는 자주 사용하는 몇가지를 Anko의 힘을 빌리면 쉽게 구현할 수 있으니 잘 기억해야 한다.

- 테마를 수정하면 앱의 전체 분위기를 바꿀 수 있다.
- 웹 뷰는 웹 페이지를 표시하는 뷰이고 인터넷 권한이 필요하다
- 메뉴는 옵션 메뉴와 컨텍스트 메뉴가 있다. 메뉴 리소스 파일을 작성하면 쉽게 메뉴를 구성할 수 있다.
- 전화걸기, 문자 보내기, 이메일 보내기 등은 다른 액티비티를 활용하는 암시적 인텐트의 대표적이 예이다. Anko를 사용하면 암시적 인텐트를 쉽게 활용할 수 있다.



